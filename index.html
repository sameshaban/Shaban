<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>فتح تطبيق دليل</title>

  <style>
    body { font-family: Arial, sans-serif; direction: rtl; margin: 24px; }
    .box { max-width: 520px; margin: 0 auto; padding: 18px; border: 1px solid #ddd; border-radius: 12px; }
    h2 { margin: 0 0 12px; }
    p { line-height: 1.7; }
    a.btn {
      display: inline-block; margin: 8px 6px 0 0; padding: 10px 14px;
      border-radius: 10px; text-decoration: none; border: 1px solid #000;
    }
  </style>
</head>

<body>
  <div class="box">
    <h2>جارٍ فتح التطبيق…</h2>
    <p>
      إذا لم يفتح التطبيق تلقائيًا خلال ثوانٍ، استخدم الأزرار بالأسفل.
    </p>

    <a class="btn" id="openBtn" href="#">فتح التطبيق</a>
    <a class="btn" id="storeBtn" href="#">فتح متجر Google Play</a>
  </div>

  <script>
    // ======= عدّل الباكج هنا إذا لزم =======
    const PACKAGE_NAME = "com.shaban.dalil";
    const PLAY_STORE_URL = "https://play.google.com/store/apps/details?id=" + PACKAGE_NAME;

    // (اختياري) دعم باراميترات مثل ?id=123&type=place
    const params = new URLSearchParams(window.location.search);
    const id = params.get("id") || "";
    const type = params.get("type") || "";

    // يمكنك تغيير "open" لمسار منطقي داخل intent (ليس شرط)
    // نضمّن البيانات في query حتى تقرأها داخل التطبيق إذا كان عندك deep link/intent handling
    const deepPath = "open" + (id ? ("?id=" + encodeURIComponent(id) + (type ? ("&type=" + encodeURIComponent(type)) : "")) : "");

    // Intent URI (الأكثر شيوعًا لفتح التطبيق)
    // ملاحظة: بعض الأجهزة/المتصفحات قد تمنع الفتح التلقائي، لذلك وضعنا زر يدوي أيضًا
    const INTENT_URL =
      "intent://" + deepPath +
      "#Intent;scheme=dalil;package=" + PACKAGE_NAME + ";end;";

    // أزرار احتياطية
    document.getElementById("openBtn").setAttribute("href", INTENT_URL);
    document.getElementById("storeBtn").setAttribute("href", PLAY_STORE_URL);

    // محاولة فتح التطبيق تلقائيًا
    const start = Date.now();
    window.location.href = INTENT_URL;

    // إذا لم ينتقل المستخدم للتطبيق غالبًا سيبقى في الصفحة، فنحوّله للمتجر بعد 2 ثانية
    setTimeout(function () {
      // إذا مازال في الصفحة بعد مدة، وجّه للمتجر
      // (لا يوجد كشف مثالي، هذا أسلوب شائع)
      if (Date.now() - start < 2500) {
        window.location.href = PLAY_STORE_URL;
      }
    }, 2000);
  </script>
</body>
</html>
